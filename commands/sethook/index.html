<!DOCTYPE html>
<html lang="en" class="command">
<head>
	<title>SETHOOK - Tile38</title>
	<link href="/assets/css/site.css" rel="stylesheet" type="text/css" />
	<link rel="icon" type="image/png" href="/assets/img/favicon-96x96.png" sizes="96x96" />
</head>
<body>
	<div class="top-bar">
		<div class="inner">
			<div class="logo"><a href="/"><img src="/assets/img/logoh200.png" alt="Tile38"></a></div>
			<a href="/commands">Commands</a
			><a href="/documentation">Documentation</a
			><a href="https://github.com/tidwall/tile38">Github</a
			><a href="/license">License</a
			>
		</div>
	</div>
	<div class="logo-bar">
		<img src="/assets/img/logo1500.png" width="200" height="200" alt="Tile38">
	</div>
	<div class="content">
		
		<h2 class="command-title">
			SETHOOK name endpoint NEARBY|WITHIN|INTERSECTS key FENCE param [param ...]
		</h2>
		<div class="related-commands">
			<div>Related commands</div>
			<ul>
				
					<li ><a href="/commands/delhook">DELHOOK</a></li>
				
					<li ><a href="/commands/hooks">HOOKS</a></li>
				
					<li class="sel"><a href="/commands/sethook">SETHOOK</a></li>
				
			</ul>
		</div>
		
		<div class="inner">
			<p>Creates a webhook which points to <a href="/topics/geofencing">geofenced</a> search. If a hook is already associated to that name, it&rsquo;ll be overwritten.</p>

<h2>Examples</h2>

<p>Set a simple hook.</p>

<p><code class="block"><keyword>SETHOOK</keyword> warehouse <a href="http://10.0.20.78/endpoint">http://10.0.20.78/endpoint</a> <keyword>NEARBY</keyword> fleet <keyword>FENCE</keyword> <keyword>POINT</keyword> <number>33.5123</number> <number>-112.2693</number> <number>500</number></code></p>

<p>In this example we created a webhook named <code>warehouse</code> that watches for changes to objects in the <code>fleet</code> collection. When a change occurs the endpoint <code>'http://10.0.20.78/endpoint'</code> is notified with a detailed message. The message contains a member named <code>'detect'</code> which has one of the following values:</p>

<ul>
<li><strong><code>inside</code></strong> is when an object is inside the specified area.</li>
<li><strong><code>outside</code></strong> is when an object is outside the specified area.</li>
<li><strong><code>enter</code></strong> is when an object that <strong>was not</strong> previously in the fence has entered the area.</li>
<li><strong><code>exit</code></strong> is when an object that <strong>was</strong> previously in the fence has exited the area.</li>
<li><strong><code>cross</code></strong> is when an object that <strong>was not</strong> previously in the fence has entered <strong>and</strong> exited the area.</li>
</ul>

<p><em>For more information on the format of this message please see the topic on <a href="/topics/geofencing">Geofencing</a>.</em></p>

<p><a href="/commands/nearby">NEARBY</a>, <a href="/commands/intersects">INTERSECTS</a>, and <a href="/commands/within">WITHIN</a> are supported search types. The <code>FENCE</code> keyword must be present.</p>

<h2>Endpoints</h2>

<p>Tile38 currently supports endpoints with the <strong><code>http</code></strong>, <strong><code>https</code></strong>, and <strong><code>disque</code></strong> url schemes.</p>

<h3>HTTP / HTTPS</h3>

<p>When using the <code>http://</code> and <code>https://</code> url scheme, Tile38 will simply perform an HTTP POST to the specified url with the <code>content-type</code> of <code>application/json</code> and the request body containing the message.</p>

<p>Tile38 expects that the endpoint will respond with the status code of 200. As long as the status is 200, then Tile38 will consider the message sent.</p>

<h3>Disque</h3>

<p>The <code>disque://</code> url scheme provide support for sending messages to a <a href="https://github.com/antirez/disque">Disque</a> server.</p>

<p>For example:</p>

<p><code class="block"><keyword>SETHOOK</keyword> warehouse disque://10.0.20.78:7711/warehouse?replicate=2 &hellip;</code></p>

<p>All webhook messages will be sent to the Disque server at <code>10.0.20.78:7711</code>. The replicate param is optional and when this value is greater than one, Tile38 will require that the Disque server to make copies of the message on N servers, where N is the value of <code>replicate</code>. Please review the <a href="https://github.com/antirez/disque#main-api">Disque API</a> for information on the replicate option.</p>

<h3>Endpoint Failover</h3>

<p>It&rsquo;s possible to specify multiple endpoints for a webhook by seperating each with a comma. Make sure that there are no spaces between the comma and the urls.</p>

<p><code class="block"><keyword>SETHOOK</keyword> warehouse <a href="http://10.0.20.78/ep1,http://10.0.20.78/ep2">http://10.0.20.78/ep1,http://10.0.20.78/ep2</a> &hellip;</code></p>

<p>Tile38 will try to send a message to the first endpoint. If the send is a failure then the second endpoint is tried, and so on.</p>
		</div>
		
		<div style="clear: both"></div>
		<br clear=both><hr><br>
		<center>
		    <a class="github-button" href="https://github.com/tidwall/tile38" data-icon="octicon-star" data-style="mega" data-count-href="/tidwall/tile38/stargazers" data-count-api="/repos/tidwall/tile38#stargazers_count" data-count-aria-label="# stargazers on GitHub" aria-label="Star tidwall/tile38 on GitHub">Star</a>
		</center>
	</div>
	

	<script>
	  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	  ga('create', 'UA-75165369-1', 'auto');
	  ga('send', 'pageview');

	</script>
	<script async defer id="github-bjs" src="https://buttons.github.io/buttons.js"></script>
</body>
</html>